{{- /* Ultra-Zen Secrets Loading */ -}}
{{- /* "Secrets flow into the environment like water into a vessel" */ -}}

# Secrets Auto-Loading for Fish Shell
# Loads secrets from ~/.local/state/secrets/ into environment variables
# This runs automatically when Fish starts

# Load environment variable files from secrets directory
if test -d ~/.local/state/secrets/env
    for file in ~/.local/state/secrets/env/*
        # Source each env file to load variables
        if test -f $file
            source $file
        end
    end
end

# Set VPN credentials as environment variables
# These are available for any scripts that might need them
if test -f ~/.local/state/secrets/openvpn/goosevpn-auth
    # Read credentials into environment (first line = user, second = pass)
    set -l auth_lines (cat ~/.local/state/secrets/openvpn/goosevpn-auth)
    if test (count $auth_lines) -eq 2
        set -gx GOOSE_VPN_USER $auth_lines[1]
        set -gx GOOSE_VPN_PASS $auth_lines[2]
    end
end

# SSH Agent Socket (example for future secrets)
# if test -f ~/.local/state/secrets/ssh/agent-socket
#     set -gx SSH_AUTH_SOCK (cat ~/.local/state/secrets/ssh/agent-socket)
# end