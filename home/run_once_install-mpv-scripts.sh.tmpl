#!/usr/bin/env bash
# Setup MPV directories and ensure lf integration
# This script runs once on chezmoi apply to set up MPV directories

set -euo pipefail

# Configuration
MPV_CONFIG_DIR="$HOME/.config/mpv"
SCRIPTS_DIR="$MPV_CONFIG_DIR/scripts"

# Color output helpers
info() { echo "[INFO] $*"; }
success() { echo "[✓] $*"; }
warning() { echo "[!] $*"; }
error() { echo "[✗] $*" >&2; }

# Check if mpv is installed
if ! command -v mpv &>/dev/null; then
    warning "mpv not installed yet, skipping script installation"
    exit 0
fi

info "Setting up mpv directories..."

# Create scripts directory (lf-browser.lua will be placed here by chezmoi)
if [[ ! -d "$SCRIPTS_DIR" ]]; then
    mkdir -p "$SCRIPTS_DIR"
    info "Created mpv scripts directory"
fi

# Create state directories for mpv
mkdir -p ~/.local/state/mpv/watch_later
mkdir -p ~/Pictures/mpv

success "MPV setup complete!"
info "LF file browser accessible with 'b' key in mpv"
info "Use 'mp' to play media with lf browser, 'mps' for status"